# fgt-webui-tools
FortiGate WebUI Tools

- Copy and paste the **FGT WebUI Tools** script code below into a new bookmark of your web browser. Click it to add a [`ðŸ§° Tools`] menu within your FortiGate WebUI.

```javascript
javascript:(async function(){let version="0.2.4";function t(){let e=document.createElement("div");return e.textContent="1",e.style.position="absolute",e.style.top="50%",e.style.transform="translateY(-50%)",e.style.width="20px",e.style.height="20px",e.style.borderRadius="50%",e.style.backgroundColor="red",e.style.color="white",e.style.fontSize="12px",e.style.textAlign="center",e.style.lineHeight="20px",e}function n(){let e=document.createElement("li");return e.style.listStyle="none",e.style.position="relative",e.style.color="black",e.style.backgroundColor="#FFD700",e.style.margin=0,e.style.padding="6px 0 5px 35px",e.style.cursor="pointer",e.style.fontWeight="normal",e.addEventListener("mousedown",e=>{e.preventDefault()}),e.onmouseover=function(){"active"!==this.dataset.active&&(this.style["background-color"]="#FFE86D")},e.onmouseout=function(){"active"!==this.dataset.active&&(this.style["background-color"]="#FFD700")},e}fetch("https://api.github.com/repos/fwsec/fgt-webui-tools/contents").then(e=>{if(!e.ok)throw Error("Network response was not ok");return e.json()}).then(a=>{let r=/fgt_webui_tools_v([0-9]+\.[0-9]+\.[0-9]+)\.js/,i=a.find(e=>r.test(e.name));if(!i)return;let s=i.name.match(r),o=s[1];if(o!==version){let l=n();l.innerText="Update available!";let d=t();d.style.left="8px",l.onclick=function(){L({script:async function(t){let n=document.createElement("table");n.innerHTML='<tbody><tr><td colspan="2"><span style="font-weight:bold">FortiGate WebUI Tools</span></td></tr><tr><td>Current Version:</td><td>'+version+"</td></tr><tr><td>New Version:</td><td>"+o+"</td></tr></tbody>",n.style.borderSpacing="8px",n.style.paddingBottom="10px";let a=document.createElement("a");a.href="https://fwsec.github.io/fgt-webui-tools/",a.innerText="View latest version on GitHub",a.target="_blank",a.style.marginLeft="8px",t.innerHTML="",t.style.overflow="auto",t.style.padding="1.5rem",t.appendChild(n),t.appendChild(a)}})},l.appendChild(d),document.getElementById("custom-menu").appendChild(l);let c=document.getElementById("menu-toggle"),p=t();p.style.right="28px",c.appendChild(p)}}).catch(e=>{console.log("Fetch error: ",e)}),document.contains(document.getElementById("tools"))&&document.getElementById("tools").remove(),!function e(){let t=document.createElement("style");t.innerHTML="code[class*=language-],pre[class*=language-]{color:#000;background:0 0;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{position:relative;margin:.5em 0;overflow:visible;padding:1px}pre[class*=language-]>code{position:relative;z-index:1;border-left:9px solid #499258;box-shadow:-1px 0 0 0 #358ccb,0 0 0 1px #dfdfdf;background-color:#fdfdfd;background-image:linear-gradient(transparent 50%,rgba(69,142,209,.04) 50%);background-size:3em 3em;background-origin:content-box;background-attachment:local}code[class*=language-]{max-height:inherit;height:inherit;padding:0 1em;display:block;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdfdfd;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;margin-bottom:1em}:not(pre)>code[class*=language-]{position:relative;padding:.2em;border-radius:.3em;color:#c92c2c;border:1px solid rgba(0,0,0,.1);display:inline;white-space:normal}pre[class*=language-]:before,pre[class*=language-]:after {display:none}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#7d8b99}.token.punctuation{color:#5f6364}.token.boolean,.token.constant,.token.deleted,.token.function-name,.token.number,.token.property,.token.symbol,.token.tag{color:#c92c2c}.token.attr-name,.token.builtin,.token.char,.token.function,.token.inserted,.token.selector,.token.string{color:#2f9c0a}.token.entity,.token.operator,.token.url,.token.variable{color:#a67f59;background:rgba(255,255,255,.5)}.token.atrule,.token.attr-value,.token.class-name,.token.keyword{color:#1990b8}.token.important,.token.regex{color:#e90}.language-css .token.string,.style .token.string{color:#a67f59;background:rgba(255,255,255,.5)}.token.important{font-weight:400}.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.namespace{opacity:.7}@media screen and (max-width:767px){pre[class*=language-]:after,pre[class*=language-]:before{bottom:14px;box-shadow:none}}pre[class*=language-].line-numbers.line-numbers{padding-left:0}pre[class*=language-].line-numbers.line-numbers code{padding-left:3.8em}pre[class*=language-].line-numbers.line-numbers .line-numbers-rows{left:0}pre[class*=language-][data-line]{padding-top:0;padding-bottom:0;padding-left:0}pre[data-line] code{position:relative;padding-left:4em}pre .line-highlight{margin-top:0}",document.head.appendChild(t);let n=document.createElement("script");n.innerHTML='var _self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(e){var n=/(?:^|\\s)lang(?:uage)?-([\\w-]+)(?=\\s|$)/i,t=0,r={},a={manual:e.Prism&&e.Prism.manual,disableWorkerMessageHandler:e.Prism&&e.Prism.disableWorkerMessageHandler,util:{encode:function e(n){return n instanceof i?new i(n.type,e(n.content),n.alias):Array.isArray(n)?n.map(e):n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).slice(8,-1)},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++t}),e.__id},clone:function e(n,t){var r,i;switch(t=t||{},a.util.type(n)){case"Object":if(i=a.util.objId(n),t[i])return t[i];for(var l in r={},t[i]=r,n)n.hasOwnProperty(l)&&(r[l]=e(n[l],t));return r;case"Array":return i=a.util.objId(n),t[i]?t[i]:(r=[],t[i]=r,n.forEach((function(n,a){r[a]=e(n,t)})),r);default:return n}},getLanguage:function(e){for(;e;){var t=n.exec(e.className);if(t)return t[1].toLowerCase();e=e.parentElement}return"none"},setLanguage:function(e,t){e.className=e.className.replace(RegExp(n,"gi"),""),e.classList.add("language-"+t)},currentScript:function(){if("undefined"==typeof document)return null;if("currentScript"in document)return document.currentScript;try{throw new Error}catch(r){var e=(/at [^(\\r\\n]*\\((.*):[^:]+:[^:]+\\)$/i.exec(r.stack)||[])[1];if(e){var n=document.getElementsByTagName("script");for(var t in n)if(n[t].src==e)return n[t]}return null}},isActive:function(e,n,t){for(var r="no-"+n;e;){var a=e.classList;if(a.contains(n))return!0;if(a.contains(r))return!1;e=e.parentElement}return!!t}},languages:{plain:r,plaintext:r,text:r,txt:r,extend:function(e,n){var t=a.util.clone(a.languages[e]);for(var r in n)t[r]=n[r];return t},insertBefore:function(e,n,t,r){var i=(r=r||a.languages)[e],l={};for(var o in i)if(i.hasOwnProperty(o)){if(o==n)for(var s in t)t.hasOwnProperty(s)&&(l[s]=t[s]);t.hasOwnProperty(o)||(l[o]=i[o])}var u=r[e];return r[e]=l,a.languages.DFS(a.languages,(function(n,t){t===u&&n!=e&&(this[n]=l)})),l},DFS:function e(n,t,r,i){i=i||{};var l=a.util.objId;for(var o in n)if(n.hasOwnProperty(o)){t.call(n,o,n[o],r||o);var s=n[o],u=a.util.type(s);"Object"!==u||i[l(s)]?"Array"!==u||i[l(s)]||(i[l(s)]=!0,e(s,t,o,i)):(i[l(s)]=!0,e(s,t,null,i))}}},plugins:{},highlightAll:function(e,n){a.highlightAllUnder(document,e,n)},highlightAllUnder:function(e,n,t){var r={callback:t,container:e,selector:\'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code\'};a.hooks.run("before-highlightall",r),r.elements=Array.prototype.slice.apply(r.container.querySelectorAll(r.selector)),a.hooks.run("before-all-elements-highlight",r);for(var i,l=0;i=r.elements[l++];)a.highlightElement(i,!0===n,r.callback)},highlightElement:function(n,t,r){var i=a.util.getLanguage(n),l=a.languages[i];a.util.setLanguage(n,i);var o=n.parentElement;o&&"pre"===o.nodeName.toLowerCase()&&a.util.setLanguage(o,i);var s={element:n,language:i,grammar:l,code:n.textContent};function u(e){s.highlightedCode=e,a.hooks.run("before-insert",s),s.element.innerHTML=s.highlightedCode,a.hooks.run("after-highlight",s),a.hooks.run("complete",s),r&&r.call(s.element)}if(a.hooks.run("before-sanity-check",s),(o=s.element.parentElement)&&"pre"===o.nodeName.toLowerCase()&&!o.hasAttribute("tabindex")&&o.setAttribute("tabindex","0"),!s.code)return a.hooks.run("complete",s),void(r&&r.call(s.element));if(a.hooks.run("before-highlight",s),s.grammar)if(t&&e.Worker){var c=new Worker(a.filename);c.onmessage=function(e){u(e.data)},c.postMessage(JSON.stringify({language:s.language,code:s.code,immediateClose:!0}))}else u(a.highlight(s.code,s.grammar,s.language));else u(a.util.encode(s.code))},highlight:function(e,n,t){var r={code:e,grammar:n,language:t};if(a.hooks.run("before-tokenize",r),!r.grammar)throw new Error(\'The language "\'+r.language+\'" has no grammar.\');return r.tokens=a.tokenize(r.code,r.grammar),a.hooks.run("after-tokenize",r),i.stringify(a.util.encode(r.tokens),r.language)},tokenize:function(e,n){var t=n.rest;if(t){for(var r in t)n[r]=t[r];delete n.rest}var a=new s;return u(a,a.head,e),o(e,a,n,a.head,0),function(e){for(var n=[],t=e.head.next;t!==e.tail;)n.push(t.value),t=t.next;return n}(a)},hooks:{all:{},add:function(e,n){var t=a.hooks.all;t[e]=t[e]||[],t[e].push(n)},run:function(e,n){var t=a.hooks.all[e];if(t&&t.length)for(var r,i=0;r=t[i++];)r(n)}},Token:i};function i(e,n,t,r){this.type=e,this.content=n,this.alias=t,this.length=0|(r||"").length}function l(e,n,t,r){e.lastIndex=n;var a=e.exec(t);if(a&&r&&a[1]){var i=a[1].length;a.index+=i,a[0]=a[0].slice(i)}return a}function o(e,n,t,r,s,g){for(var f in t)if(t.hasOwnProperty(f)&&t[f]){var h=t[f];h=Array.isArray(h)?h:[h];for(var d=0;d<h.length;++d){if(g&&g.cause==f+","+d)return;var v=h[d],p=v.inside,m=!!v.lookbehind,y=!!v.greedy,k=v.alias;if(y&&!v.pattern.global){var x=v.pattern.toString().match(/[imsuy]*$/)[0];v.pattern=RegExp(v.pattern.source,x+"g")}for(var b=v.pattern||v,w=r.next,A=s;w!==n.tail&&!(g&&A>=g.reach);A+=w.value.length,w=w.next){var E=w.value;if(n.length>e.length)return;if(!(E instanceof i)){var P,L=1;if(y){if(!(P=l(b,A,e,m))||P.index>=e.length)break;var S=P.index,O=P.index+P[0].length,j=A;for(j+=w.value.length;S>=j;)j+=(w=w.next).value.length;if(A=j-=w.value.length,w.value instanceof i)continue;for(var C=w;C!==n.tail&&(j<O||"string"==typeof C.value);C=C.next)L++,j+=C.value.length;L--,E=e.slice(A,j),P.index-=A}else if(!(P=l(b,0,E,m)))continue;S=P.index;var N=P[0],_=E.slice(0,S),M=E.slice(S+N.length),W=A+E.length;g&&W>g.reach&&(g.reach=W);var z=w.prev;if(_&&(z=u(n,z,_),A+=_.length),c(n,z,L),w=u(n,z,new i(f,p?a.tokenize(N,p):N,k,N)),M&&u(n,w,M),L>1){var I={cause:f+","+d,reach:W};o(e,n,t,w.prev,A,I),g&&I.reach>g.reach&&(g.reach=I.reach)}}}}}}function s(){var e={value:null,prev:null,next:null},n={value:null,prev:e,next:null};e.next=n,this.head=e,this.tail=n,this.length=0}function u(e,n,t){var r=n.next,a={value:t,prev:n,next:r};return n.next=a,r.prev=a,e.length++,a}function c(e,n,t){for(var r=n.next,a=0;a<t&&r!==e.tail;a++)r=r.next;n.next=r,r.prev=n,e.length-=a}if(e.Prism=a,i.stringify=function e(n,t){if("string"==typeof n)return n;if(Array.isArray(n)){var r="";return n.forEach((function(n){r+=e(n,t)})),r}var i={type:n.type,content:e(n.content,t),tag:"span",classes:["token",n.type],attributes:{},language:t},l=n.alias;l&&(Array.isArray(l)?Array.prototype.push.apply(i.classes,l):i.classes.push(l)),a.hooks.run("wrap",i);var o="";for(var s in i.attributes)o+=" "+s+\'="\'+(i.attributes[s]||"").replace(/"/g,"&quot;")+\'"\';return"<"+i.tag+\' class="\'+i.classes.join(" ")+\'"\'+o+">"+i.content+"</"+i.tag+">"},!e.document)return e.addEventListener?(a.disableWorkerMessageHandler||e.addEventListener("message",(function(n){var t=JSON.parse(n.data),r=t.language,i=t.code,l=t.immediateClose;e.postMessage(a.highlight(i,a.languages[r],r)),l&&e.close()}),!1),a):a;var g=a.util.currentScript();function f(){a.manual||a.highlightAll()}if(g&&(a.filename=g.src,g.hasAttribute("data-manual")&&(a.manual=!0)),!a.manual){var h=document.readyState;"loading"===h||"interactive"===h&&g&&g.defer?document.addEventListener("DOMContentLoaded",f):window.requestAnimationFrame?window.requestAnimationFrame(f):window.setTimeout(f,16)}return a}(_self);"undefined"!=typeof module&&module.exports&&(module.exports=Prism),"undefined"!=typeof global&&(global.Prism=Prism);',document.head.appendChild(n);let a=document.createElement("script");a.innerHTML='!function(e){var t="\\\\b(?:BASH|BASHOPTS|BASH_ALIASES|BASH_ARGC|BASH_ARGV|BASH_CMDS|BASH_COMPLETION_COMPAT_DIR|BASH_LINENO|BASH_REMATCH|BASH_SOURCE|BASH_VERSINFO|BASH_VERSION|COLORTERM|COLUMNS|COMP_WORDBREAKS|DBUS_SESSION_BUS_ADDRESS|DEFAULTS_PATH|DESKTOP_SESSION|DIRSTACK|DISPLAY|EUID|GDMSESSION|GDM_LANG|GNOME_KEYRING_CONTROL|GNOME_KEYRING_PID|GPG_AGENT_INFO|GROUPS|HISTCONTROL|HISTFILE|HISTFILESIZE|HISTSIZE|HOME|HOSTNAME|HOSTTYPE|IFS|INSTANCE|JOB|LANG|LANGUAGE|LC_ADDRESS|LC_ALL|LC_IDENTIFICATION|LC_MEASUREMENT|LC_MONETARY|LC_NAME|LC_NUMERIC|LC_PAPER|LC_TELEPHONE|LC_TIME|LESSCLOSE|LESSOPEN|LINES|LOGNAME|LS_COLORS|MACHTYPE|MAILCHECK|MANDATORY_PATH|NO_AT_BRIDGE|OLDPWD|OPTERR|OPTIND|ORBIT_SOCKETDIR|OSTYPE|PAPERSIZE|PATH|PIPESTATUS|PPID|PS1|PS2|PS3|PS4|PWD|RANDOM|REPLY|SECONDS|SELINUX_INIT|SESSION|SESSIONTYPE|SESSION_MANAGER|SHELL|SHELLOPTS|SHLVL|SSH_AUTH_SOCK|TERM|UID|UPSTART_EVENTS|UPSTART_INSTANCE|UPSTART_JOB|UPSTART_SESSION|USER|WINDOWID|XAUTHORITY|XDG_CONFIG_DIRS|XDG_CURRENT_DESKTOP|XDG_DATA_DIRS|XDG_GREETER_DATA_DIR|XDG_MENU_PREFIX|XDG_RUNTIME_DIR|XDG_SEAT|XDG_SEAT_PATH|XDG_SESSION_DESKTOP|XDG_SESSION_ID|XDG_SESSION_PATH|XDG_SESSION_TYPE|XDG_VTNR|XMODIFIERS)\\\\b",a={pattern:/(^(["\']?)\\w+\\2)[ \\t]+\\S.*/,lookbehind:!0,alias:"punctuation",inside:null},n={bash:a,environment:{pattern:RegExp("\\\\$"+t),alias:"constant"},variable:[{pattern:/\\$?\\(\\([\\s\\S]+?\\)\\)/,greedy:!0,inside:{variable:[{pattern:/(^\\$\\(\\([\\s\\S]+)\\)\\)/,lookbehind:!0},/^\\$\\(\\(/],number:/\\b0x[\\dA-Fa-f]+\\b|(?:\\b\\d+(?:\\.\\d*)?|\\B\\.\\d+)(?:[Ee]-?\\d+)?/,operator:/--|\\+\\+|\\*\\*=?|<<=?|>>=?|&&|\\|\\||[=!+\\-*/%<>^&|]=?|[?~:]/,punctuation:/\\(\\(?|\\)\\)?|,|;/}},{pattern:/\\$\\((?:\\([^)]+\\)|[^()])+\\)|`[^`]+`/,greedy:!0,inside:{variable:/^\\$\\(|^`|\\)$|`$/}},{pattern:/\\$\\{[^}]+\\}/,greedy:!0,inside:{operator:/:[-=?+]?|[!\\/]|##?|%%?|\\^\\^?|,,?/,punctuation:/[\\[\\]]/,environment:{pattern:RegExp("(\\\\{)"+t),lookbehind:!0,alias:"constant"}}},/\\$(?:\\w+|[#?*!@$])/],entity:/\\\\(?:[abceEfnrtv\\\\"]|O?[0-7]{1,3}|U[0-9a-fA-F]{8}|u[0-9a-fA-F]{4}|x[0-9a-fA-F]{1,2})/};e.languages.bash={shebang:{pattern:/^#!\\s*\\/.*/,alias:"important"},comment:{pattern:/(^|[^"{\\\\$])#.*/,lookbehind:!0},"function-name":[{pattern:/(\\bfunction\\s+)[\\w-]+(?=(?:\\s*\\(?:\\s*\\))?\\s*\\{)/,lookbehind:!0,alias:"function"},{pattern:/\\b[\\w-]+(?=\\s*\\(\\s*\\)\\s*\\{)/,alias:"function"}],"for-or-select":{pattern:/(\\b(?:for|select)\\s+)\\w+(?=\\s+in\\s)/,alias:"variable",lookbehind:!0},"assign-left":{pattern:/(^|[\\s;|&]|[<>]\\()\\w+(?:\\.\\w+)*(?=\\+?=)/,inside:{environment:{pattern:RegExp("(^|[\\\\s;|&]|[<>]\\\\()"+t),lookbehind:!0,alias:"constant"}},alias:"variable",lookbehind:!0},parameter:{pattern:/(^|\\s)-{1,2}(?:\\w+:[+-]?)?\\w+(?:\\.\\w+)*(?=[=\\s]|$)/,alias:"variable",lookbehind:!0},string:[{pattern:/((?:^|[^<])<<-?\\s*)(\\w+)\\s[\\s\\S]*?(?:\\r?\\n|\\r)\\2/,lookbehind:!0,greedy:!0,inside:n},{pattern:/((?:^|[^<])<<-?\\s*)(["\'])(\\w+)\\2\\s[\\s\\S]*?(?:\\r?\\n|\\r)\\3/,lookbehind:!0,greedy:!0,inside:{bash:a}},{pattern:/(^|[^\\\\](?:\\\\\\\\)*)"(?:\\\\[\\s\\S]|\\$\\([^)]+\\)|\\$(?!\\()|`[^`]+`|[^"\\\\`$])*"/,lookbehind:!0,greedy:!0,inside:n},{pattern:/(^|[^$\\\\])\'[^\']*\'/,lookbehind:!0,greedy:!0},{pattern:/\\$\'(?:[^\'\\\\]|\\\\[\\s\\S])*\'/,greedy:!0,inside:{entity:n.entity}}],environment:{pattern:RegExp("\\\\$?"+t),alias:"constant"},variable:n.variable,function:{pattern:/(^|[\\s;|&]|[<>]\\()(?:add|apropos|apt|apt-cache|apt-get|aptitude|aspell|automysqlbackup|awk|basename|bash|bc|bconsole|bg|bzip2|cal|cargo|cat|cfdisk|chgrp|chkconfig|chmod|chown|chroot|cksum|clear|cmp|column|comm|composer|cp|cron|crontab|csplit|curl|cut|date|dc|dd|ddrescue|debootstrap|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|docker|docker-compose|du|egrep|eject|env|ethtool|expand|expect|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|git|gparted|grep|groupadd|groupdel|groupmod|groups|grub-mkconfig|gzip|halt|head|hg|history|host|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|ip|java|jobs|join|kill|killall|less|link|ln|locate|logname|logrotate|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|lynx|make|man|mc|mdadm|mkconfig|mkdir|mke2fs|mkfifo|mkfs|mkisofs|mknod|mkswap|mmv|more|most|mount|mtools|mtr|mutt|mv|nano|nc|netstat|nice|nl|node|nohup|notify-send|npm|nslookup|op|open|parted|passwd|paste|pathchk|ping|pkill|pnpm|podman|podman-compose|popd|pr|printcap|printenv|ps|pushd|pv|quota|quotacheck|quotactl|ram|rar|rcp|reboot|remsync|rename|renice|rev|rm|rmdir|rpm|rsync|scp|screen|sdiff|sed|sendmail|seq|service|sftp|sh|shellcheck|shuf|shutdown|sleep|slocate|sort|split|ssh|stat|strace|su|sudo|sum|suspend|swapon|sync|sysctl|tac|tail|tar|tee|time|timeout|top|touch|tr|traceroute|tsort|tty|umount|uname|unexpand|uniq|units|unrar|unshar|unzip|update-grub|uptime|useradd|userdel|usermod|users|uudecode|uuencode|v|vcpkg|vdir|vi|vim|virsh|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yarn|yes|zenity|zip|zsh|zypper)(?=$|[)\\s;|&])/,lookbehind:!0},keyword:{pattern:/(^|[\\s;|&]|[<>]\\()(?:case|do|done|elif|else|esac|fi|for|function|if|in|select|then|until|while)(?=$|[)\\s;|&])/,lookbehind:!0},builtin:{pattern:/(^|[\\s;|&]|[<>]\\()(?:\\.|:|alias|bind|break|builtin|caller|cd|command|continue|declare|echo|enable|eval|exec|exit|export|getopts|hash|help|let|local|logout|mapfile|printf|pwd|read|readarray|readonly|return|set|shift|shopt|source|test|times|trap|type|typeset|ulimit|umask|unalias|unset)(?=$|[)\\s;|&])/,lookbehind:!0,alias:"class-name"},boolean:{pattern:/(^|[\\s;|&]|[<>]\\()(?:false|true)(?=$|[)\\s;|&])/,lookbehind:!0},"file-descriptor":{pattern:/\\B&\\d\\b/,alias:"important"},operator:{pattern:/\\d?<>|>\\||\\+=|=[=~]?|!=?|<<[<-]?|[&\\d]?>>|\\d[<>]&?|[<>][&=]?|&[>&]?|\\|[&|]?/,inside:{"file-descriptor":{pattern:/^\\d/,alias:"important"}}},punctuation:/\\$?\\(\\(?|\\)\\)?|\\.\\.|[{}[\\];\\\\]/,number:{pattern:/(^|\\s)(?:[1-9]\\d*|0)(?:[.,]\\d+)?\\b/,lookbehind:!0}},a.inside=e.languages.bash;for(var s=["comment","function-name","for-or-select","assign-left","parameter","string","environment","function","keyword","builtin","boolean","file-descriptor","operator","punctuation","number"],o=n.variable[1].inside,i=0;i<s.length;i++)o[s[i]]=e.languages.bash[s[i]];e.languages.sh=e.languages.bash,e.languages.shell=e.languages.bash}(Prism);',document.head.appendChild(a)}(),Prism.languages.bash={...Prism.languages.bash,keyword:{pattern:/(^|[\s;|&]|[<>]\()(?:case|do|done|elif|else|esac|fi|for|function|if|in|select|then|until|while|set)(?=$|[)\s;|&])/,lookbehind:!0}};let a=function e(){let t=document.querySelectorAll("script[src]"),n=Array.from(t).find(e=>/\/[a-f0-9]{32}\/runtime\.js/.test(e.src)),a=n.src.match(/\/([a-f0-9]{32})\/runtime\.js/)[1];return a}();!function e(t){let n=document.createElement("link");n.rel="stylesheet",n.href=t,n.type="text/css",document.head.appendChild(n)}("/"+a+"/css/legacy-main.css");let r="_cliWS",i="",s=["get system status","get system global","get system settings"],o=["get system arp","diag ip arp list"],l=["show system ntp","diag sys ntp status","diag sys dayst-info"],d='<svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg" style="width: 18px; height: 18px;"><path d="m12.01 9.531-4.25 4.25a.747.747 0 0 1-1.06 0l-.706-.706a.747.747 0 0 1 0-1.06l3.012-3.012-3.012-3.012a.747.747 0 0 1 0-1.06l.703-.712a.747.747 0 0 1 1.06 0l4.25 4.25a.748.748 0 0 1 .002 1.062z"></path></svg></nu-icon>',c='<nu-icon class="icon" style="margin-left:auto;width:18px;height:14px;transform:rotate(0deg)">'+d,p=window[r],g=!1,m;function y(e){p.send(e+"\r\n")}function b(e,t){t.parentNode.insertBefore(e,t.nextSibling)}function h(e,t){let n=["sys_cmd","arp_cmd1","arp_cmd2"].includes(t),a=n?document.querySelector('table[data-command="'+m+'"]'):document.querySelector('code[data-command="'+m+'"]'),r;if(!a){switch(n||((r=document.createElement("pre")).classList.add("language-bash"),r.dataset.active="active"),(a=n?document.createElement("table"):document.createElement("code")).dataset.command=m,a.dataset.active="active",a.style.margin="1rem",a.style.display="block",t){case"sys_cmd":a.innerHTML='<tr><th style="border:1px solid grey;">Key</th><th style="border:1px solid grey;">Value</th></tr>';break;case"arp_cmd1":a.innerHTML='<tr><th style="border:1px solid grey;text-align:left">IP Address</th><th style="border:1px solid grey">Age(min)</th><th style="border:1px solid grey">MAC Address</th><th style="border:1px solid grey">Interface</th></tr>';break;case"arp_cmd2":a.innerHTML='<tr><th style="border:1px solid grey">Interface</th><th style="border:1px solid grey;text-align:left">IP Address</th><th style="border:1px solid grey">MAC Address</th><th style="border:1px solid grey;text-align:left">Status</th><th style="border:1px solid grey">Use</th><th style="border:1px solid grey">Confirm</th><th style="border:1px solid grey">Update</th><th style="border:1px solid grey">Ref</th></tr>';break;default:a.innerHTML=""}let i=document.querySelector('li[data-command="'+m+'"]');n?b(a,i):(r.appendChild(a),b(r,i))}switch(t){case"sys_cmd":let[s,o]=e.split(/:(.*)/s);o=(o=(o=(o=o.replace(/[dD]isable/g,'<f-icon class="fa-disabled"></f-icon>&nbsp;<span style="color:silver">Disabled</span>')).replace(/[nN]ot [aV]vailable/g,'<f-icon class="fa-disabled"></f-icon>&nbsp;<span style="color:silver">Not available</span>')).replace(/[eE]nable/g,'<f-icon class="fa-enabled"></f-icon>&nbsp;<span>Enabled</span>')).replace(/[cC]ertified/g,'<f-icon class="fa-enabled"></f-icon>&nbsp;<span>Certified</span>'),a.innerHTML+='<tr><td style="border: 1px solid grey;">'+s+'</td><td style="border: 1px solid grey;">'+o+"</td></tr>";break;case"arp_cmd1":let[l,d,c,p]=e.replace(/\s+/g," ").split(" ");c.includes(":")&&(a.innerHTML+='<tr><td style="border:1px solid grey">'+l+'</td><td style="border:1px solid grey;text-align:center">'+d+'</td><td style="border:1px solid grey;text-align:center">'+c+'</td><td style="border:1px solid grey;text-align:center">'+p+"</td></tr>");break;case"arp_cmd2":let[g,y,h,$,x,E,k,S,_]=e.replace(/\s+/g," ").split(" ");x=(x=(x=(x=(x=(x=(x=(x=(x=x.replace("00000000",'<span title="Pseudo state used while an ARP entry is initially created or just before it is removed"><f-icon class="fa-connected"></f-icon>&nbsp;NONE<span>')).replace("00000001",'<span title="First ARP request sent"><f-icon class="fa-connected"></f-icon>&nbsp;INCOMPLETE</span>')).replace("00000002",'<span title="ARP response is received"><f-icon class="fa-connected"></f-icon>&nbsp;REACHABLE</span>')).replace("00000004",'<span title="ARP response is not received within expected time"><f-icon class="fa-custom-action"></f-icon>&nbsp;STALE</span>')).replace("00000008",'<span title="Schedule ARP request"><f-icon class="fa-clock-plus"></f-icon>&nbsp;DELAY</span>')).replace("00000010",'<span title="Actively sending ARP requests to try and resolve the address"><f-icon class="fa-clock-plus"></f-icon>&nbsp;PROBE</span>')).replace("00000020",'<span title="Not managed to resolve ARP within max configured number of probes"><f-icon class="fa-cancel"></f-icon>&nbsp;FAILED</span>')).replace("00000040",'<span title="Device does not support ARP e.g. IPsec Interface"><f-icon class="fa-dismiss"></f-icon>&nbsp;NOARP</span>')).replace("00000080",'<span title="Statically configured ARP entry">PERMANENT</span>'),a.innerHTML+='<tr><td style="border:1px solid grey;text-align:center">'+y.substring(y.indexOf("=")+1)+'</td><td style="border:1px solid grey">'+h+'</td><td style="border:1px solid grey;text-align:center">'+$+'</td><td style="border:1px solid grey">'+x.substring(x.indexOf("=")+1)+'</td><td style="border:1px solid grey;text-align:center">'+E.substring(E.indexOf("=")+1)+'</td><td style="border:1px solid grey;text-align:center">'+k.substring(k.indexOf("=")+1)+'</td><td style="border:1px solid grey;text-align:center">'+S.substring(S.indexOf("=")+1)+'</td><td style="border:1px solid grey;text-align:center">'+_.substring(_.indexOf("=")+1)+"</td></tr>";break;default:a.innerHTML+=e+"\n"}Prism.highlightAll()}let $="";async function x(e){let t=await e.data.text();if(g){let n="";for(let a in t){let r=t[a];"\r"===n?"\n"===r&&$.length>0?(h($,i),$=""):"\0"===r&&($=""):"\r"!==r&&($+=r),n=r}}else g=!0,y("")}function E(){let e="https:"===location.protocol?"wss:":"ws:",t=e+"//"+location.hostname+":"+location.port+"/ws/cli/open?cols=500&rows=500";window[r]=p=new WebSocket(t),p.addEventListener("message",x),p.addEventListener("close",()=>window[r]=null)}let k=[{label:"System info",content:"",script:function(e){p||E();let t=document.createElement("ul");t.id="system-info-command-list",s.forEach(e=>{let n=document.createElement("li");n.style.marginBottom="1rem",n.style.color="green",n.style.cursor="pointer",n.style.userSelect="none",n.dataset.command=e,n.innerHTML="&nbsp;"+e+c,n.onclick=function(){if(i="sys_cmd",p){let e=this.nextSibling&&"TABLE"===this.nextSibling.nodeName?this.nextSibling:null,t=this.querySelector(".icon");if(e)"active"===e.dataset.active?(e.dataset.active="",e.style.display="none",t.style.transform="rotate(0deg)"):(e.dataset.active="active",e.style.display="block",t.style.transform="rotate(90deg)");else{g=!0;let a=n.dataset.command;y(a),m=a,t.style.transform="rotate(90deg)"}}else E()},t.appendChild(n)}),e.innerHTML="",e.style.overflow="auto",e.style.padding="1.5rem",e.appendChild(t)}},{label:"ARP info",content:"",script:function(e){p||E();let t=document.createElement("ul");t.id="system-arp-command-list",o.forEach(e=>{let n=document.createElement("li");n.style.marginBottom="1rem",n.style.color="green",n.style.cursor="pointer",n.style.userSelect="none",n.dataset.command=e,n.innerHTML="&nbsp;"+e+c,n.onclick=function(){if(i="arp_cmd1","diag"==this.innerHTML.substr(6,4)&&(i="arp_cmd2"),p){let e=this.nextSibling&&"TABLE"===this.nextSibling.nodeName?this.nextSibling:null,t=this.querySelector(".icon");if(e)"active"===e.dataset.active?(e.dataset.active="",e.style.display="none",t.style.transform="rotate(0deg)"):(e.dataset.active="active",e.style.display="block",t.style.transform="rotate(90deg)");else{g=!0;let a=n.dataset.command;y(a),m=a,t.style.transform="rotate(90deg)"}}else E()},t.appendChild(n)}),e.innerHTML="",e.style.overflow="auto",e.style.padding="1.5rem",e.appendChild(t)}},{label:"Local-in policy",content:"",script:async function(e){var t,n;let a=await fetch("/api/v2/cmdb/firewall/local-in-policy"),r=await a.json(),i=await fetch("/api/v2/cmdb/firewall/local-in-policy6"),s=await i.json(),o=await fetch("/api/v2/monitor/firewall/local-in"),l=await o.json(),d=await fetch("/api/v2/monitor/system/available-interfaces?start=0&view_type=limited"),c=await d.json(),p=document.createElement("div");function g(e){for(let n of e.results){for(let a in src_="",n.srcaddr)0!=a&&(src_+="<br>"),"enable"==n["srcaddr-negate"]&&(src_+='<f-icon class="fa-negate" title="Negated" style="cursor:pointer"></f-icon>&nbsp;'),src_+=n.srcaddr[a].name;for(let r in dst_="",n.dstaddr)0!=r&&(dst_+="<br>"),"enable"==n["dstaddr-negate"]&&(dst_+='<f-icon class="fa-negate" title="Negated" style="cursor:pointer"></f-icon>&nbsp;'),dst_+=n.dstaddr[r].name.replace("all",'<f-icon class="ftnt-device-fortinet" title="This FortiGate" style="cursor:pointer"></f-icon>&nbsp;FortiGate (all)');for(let i in svc_="",n.service)0!=i&&(svc_+="<br>"),"enable"==n["service-negate"]&&(svc_+='<f-icon class="fa-negate" title="Negated" style="cursor:pointer"></f-icon>&nbsp;'),svc_+=n.service[i].name;t+='<tr style="height:32px;text-align:center"><td style="border:1px solid #E2E2E2">'+n.policyid+'</td><td style="border:1px solid #E2E2E2">'+n.status.replace("enable",'<f-icon class="fa-enabled" title="Enabled" style="cursor:pointer"></f-icon>&nbsp;Enabled').replace("disable",'<f-icon class="fa-disabled" title="Disabled" style="cursor:pointer"></f-icon>&nbsp;<span style="color:silver">Disabled</span>')+n["ha-mgmt-intf-only"].replace("enable","<br>HA&nbsp;management&nbsp;interface&nbsp;only").replace("disable","")+'</td><td style="border:1px solid #E2E2E2">'+n.intf.replace("any",'<f-icon class="fa-square-o" title="Any interface" style="cursor:pointer"></f-icon>&nbsp;any')+'</td><td style="border:1px solid #E2E2E2">'+src_+'</td><td style="border:1px solid #E2E2E2">'+dst_+'</td><td style="border:1px solid #E2E2E2">'+svc_+'</td><td style="border:1px solid #E2E2E2">'+n.action.replace("deny",'<f-icon class="fa-denied" title="Deny" style="cursor:pointer"></f-icon>&nbsp;Deny').replace("accept",'<f-icon class="fa-accepted" title="Accept" style="cursor:pointer"></f-icon>&nbsp;Accept')+'</td><td style="border:1px solid #E2E2E2">'+n.schedule+'</td><td style="border:1px solid #E2E2E2">'+n.comments+"</td></tr>"}}p.setAttribute("id","clip"),t=n="<table style='width:100%;padding:0;border-spacing:0;border-collapse:collapse'><tr>",0===r.size&&0===s.size?t+="<td style='text-align:center;color:#aaa'>No custom Local-in policy configured.</td></tr>":(u="<td style='height:37px;text-align:center;background-color:gainsboro;border:1px solid #B9B9B9' colspan='9'>Custom Local-In ",v="Policy<span style='color:#aaa'> &rarr; configured via CLI / API</span></td></tr>",w="<tr style='height:32px;text-align:center;color:#fff;background-color:#5A5A5A;border:1px solid #B9B9B9'><td>&nbsp;#&nbsp;</td><td>Status</td><td>Interface</td><td>Source</td><td>Destination</td><td>Service</td><td>Action</td><td>Schedule</td><td>Comments</td></tr>"),0!=r.size&&(0===s.size?t+=u+v+w:t+=u+"<span style='color:green'>IPv4</span> "+v+w,g(r)),0!=s.size&&(n+=u+"<span style='color:darkviolet'>IPv6</span> "+v+w,g(s)),f="</table><br><table style='width:100%;padding:0;border-spacing:0;border-collapse:collapse'><tr><td style='height:37px;text-align:center;background-color:gainsboro;border:1px solid #B9B9B9;border-bottom:0' colspan='7'>Auto Local-In Policy<span style='color:#aaa'> &rarr; managed by FortiGate</span></td></tr>";let m=e=>{switch(e){case"icmp":return 1;case"udp":return 2;case"tcp":return 3;default:return 100}};f+='<tr style="height:32px;text-align:center;color:#fff;background-color:#5A5A5A;border:1px solid #B9B9B9"><td>#</td><td>Status</td><td>Source Interface/Zone</td><td>Source</td><td>Destination</td><td>Service</td><td>Action</td></tr>',f+=Object.entries(l.results).map(e=>{let[t,n]=e,a=n.reduce((e,t)=>{let n=e.find(e=>JSON.stringify(e.from_zone)==JSON.stringify(t.from_zone)&&JSON.stringify(e.source)==JSON.stringify(t.source)&&e.action==t.action);return n&&n.services.push(...t.services),n?e:[...e,t]},[]),r=a.reduce((e,t)=>{let n=e.find(e=>JSON.stringify(e.source)==JSON.stringify(t.source)&&JSON.stringify(e.services)==JSON.stringify(t.services)&&e.action==t.action);return n&&n.from_zone.push(...t.from_zone),n?e:[...e,t]},[]),i=r.reduce((e,t)=>{let n=e.find(e=>JSON.stringify(e.from_zone)==JSON.stringify(t.from_zone)&&JSON.stringify(e.services)==JSON.stringify(t.services)&&e.action==t.action);return n&&n.source.push(...t.source),n?e:[...e,t]},[]);for(let s of i)s.services=s.services.reduce((e,t)=>{let n=e.find(e=>e.proto_name==t.proto_name&&e.dst_port_start==t.dst_port_end+1);n&&(n.dst_port_start=t.dst_port_start);let a=e.find(e=>e.proto_name==t.proto_name&&e.dst_port_end==t.dst_port_start-1);return a&&(a.dst_port_end=t.dst_port_end),n||a?e:[...e,t]},[]),s.services.sort((e,t)=>{let n=m(e.proto_name)-m(t.proto_name);return 0!=n?n:e.dst_port_start-t.dst_port_start});return"".concat('<tr style="height:32px;text-align:center;background-color:gainsboro;border:1px solid #E2E2E2">','<td colspan="7">',t.charAt(0).toUpperCase(),t.slice(1),"</td>","</tr>",r.map((e,t)=>"".concat('<tr style="height:32px;text-align:center">','<td style="border:1px solid #E2E2E2">',t+1,"</td>",'<td style="border:1px solid #E2E2E2"><f-icon class="fa-enabled" title="Enabled" style="cursor:pointer"></f-icon>&nbsp;Enabled</td>','<td style="border:1px solid #E2E2E2; padding: 10px;">',e.from_zone.map(e=>{if("any"==e)return'<f-icon class="fa-square-o" title="Any interface" style="cursor:pointer"></f-icon>&nbsp;any';let t=c.results.find(t=>t.name==e);return t?.alias&&t.alias!=e?"".concat("<f-icon style='padding-right: 3px;' class='"+t.icon+"'></f-icon>",t.alias," (",e,")"):"".concat("<f-icon style='padding-right: 3px;' class='"+t.icon+"'></f-icon>",e)}).join("<br>"),"</td>",'<td style="border:1px solid #E2E2E2">',e.source.map(e=>"0.0.0.0"==e.start&&"255.255.255.255"==e.end?"all":"".concat(e.start," - ",e.end)).join("<br>"),"</td>",'<td style="border:1px solid #E2E2E2"><f-icon class="ftnt-device-fortinet" title="This FortiGate" style="cursor:pointer"></f-icon>&nbsp;FortiGate</td>','<td style="border:1px solid #E2E2E2">',e.services.map(e=>["ospf","igmp","pim"].includes(e.proto_name)?e.proto_name:e.dst_port_start==e.dst_port_end?e.dst_port_start?"".concat(e.dst_port_start,"/",e.proto_name??"Any"):e.proto_name??"Any":"".concat(e.dst_port_start,"-",e.dst_port_end,"/",e.proto_name??"Any")).join("<br>").replace("ospf","OSPF").replace("pim","PIM").replace("igmp","IGMP").replace("8/icmp","Ping").replace("13/icmp","Timestamp").replace("53/udp","DNS (53/udp)").replace("67/udp","DHCP (67/udp)").replace("68/udp","DHCP (68/udp)").replace("123/udp","NTP (123/udp)").replace("161/udp","SNMP").replace("500/udp","IKE (ISAKMP)").replace("520/udp","RIP").replace("2048/udp","WCCP").replace("4500/udp","IPsec NAT-T").replace("22/tcp","SSH").replace("53/tcp","DNS (53/tcp)").replace("80/tcp","HTTP").replace("123/tcp","NTP (123/tcp)").replace("179/tcp","BGP").replace("443/tcp","HTTPS").replace("541/tcp","FortiManager").replace("1000/tcp","Authd (1000/tcp)").replace("1003/tcp","Authd (1003/tcp)"),"</td>",'<td style="border:1px solid #E2E2E2">',e.action.replace("drop",'<f-icon class="fa-disable" title="Drop" style="cursor:pointer"></f-icon>&nbsp;Drop').replace("accept",'<f-icon class="fa-accepted" title="Accept" style="cursor:pointer"></f-icon>&nbsp;Accept'),"</td>","</tr>")).join(""))}).join(""),f+="</table><br>&nbsp;",0===s.size?p.innerHTML=t+f:0===r.size?p.innerHTML=n+f:p.innerHTML=t+"</table><br>"+n+f,e.innerHTML="",e.style.overflow="auto",e.style.padding="1.5rem",e.appendChild(p)}},{label:"NTP info",content:"",script:async function(e){let t=await fetch("/api/v2/monitor/system/time"),n=await t.json(),a=await fetch("/api/v2/monitor/system/ntp/status"),r=await a.json(),s=await fetch("/api/v2/cmdb/system/ntp"),o=await s.json();var d=new Date(1e3*n.results.time);let b=document.createElement("div");b.setAttribute("id","pntp");let h="<table style='padding:0;border-spacing:0;border-collapse:collapse;display:block'><tr><td style='border:1px solid #ddd;background:#ddd;padding:2px 5px 2px 5px'>NTP Server</td><td style='border:1px solid #ddd;background:#ddd;padding:2px 5px 2px 5px'>IP Address</td><td style='border:1px solid #ddd;background:#ddd;padding:2px 5px 2px 5px;text-align:center'>Version</td><td style='border:1px solid #ddd;background:#ddd;padding:2px 5px 2px 5px;text-align:center'>Reachable</td></tr>";for(let $ of r.results)h+="<tr><td style='border:1px solid #ddd;padding:2px 5px 2px 5px'>"+$.server+"</td><td style='border:1px solid #ddd;padding:2px 5px 2px 5px'>"+$.ip+"</td><td style='border:1px solid #ddd;padding:2px 5px 2px 5px;text-align:center'>"+$.version+"</td><td style='border:1px solid #ddd;padding:2px 5px 2px 5px;text-align:center'>"+$.reachable+"</td></tr>";h=(h=(h=h.replace(/true/g,'<f-icon class="fa-accepted" title="Reachable" style="cursor:pointer"></f-icon>')).replace(/false/g,'<f-icon class="fa-denied" title="Unreachable" style="cursor:pointer"></f-icon>')).replace(/undefined/g,"-"),b.innerHTML="<span style='color:green'>Current system time:</span><br>"+d+"<br>&nbsp;<br>"+h+'</table><p style="white-space:nowrap">NTP server mode:&nbsp;'+o.results["server-mode"].replace(/[eE]nable/g,'<span style="color:green">Enabled</span>').replace(/[dD]isable/g,'<span style="color:pink">Disabled</span>'),p||E();let x=document.createElement("ul");x.id="ntp-sync-command-list",l.forEach(e=>{let t=document.createElement("li");t.style.marginBottom="1rem",t.style.color="green",t.style.cursor="pointer",t.style.userSelect="none",t.dataset.command=e,t.innerHTML="&nbsp;"+e+c,t.onclick=function(){if(i="default",p){let e=this.nextSibling&&"PRE"===this.nextSibling.nodeName?this.nextSibling:null,n=this.querySelector(".icon");if(e)"active"===e.dataset.active?(e.dataset.active="",e.style.display="none",n.style.transform="rotate(0deg)"):(e.dataset.active="active",e.style.display="block",n.style.transform="rotate(90deg)");else{g=!0;let a=t.dataset.command;y(a),m=a,n.style.transform="rotate(90deg)"}}else E()},x.appendChild(t)}),e.innerHTML="",e.style.overflow="auto",e.style.padding="1.5rem",e.appendChild(b).appendChild(x)}},{label:"Firewall policy",content:"",script:async function(e){let t=await fetch("/api/v2/cmdb/firewall/policy?datasource=1"),n=await t.json(),a=await fetch("/api/v2/monitor/system/available-interfaces?&vdom=root&view_type=limited"),r=await a.json(),i=new Set(["status","name","srcintf","dstintf","srcaddr","dstaddr","service","nat","schedule","action","logtraffic"]),s=new Set;for(let o of n.results){let l=Object.entries(o);for(let d of l)null!=d[1]&&!1!=d[1]&&s.add(d[0])}let c=new Set(i),p=()=>{let t="".concat('<div id="firewall-policy-customizer" style="display:none;padding:5px;position:absolute;top:75px;left:0;right:0;margin:30px 124px 30px 50px;background-color:white;border:1px solid #000;z-index:1">','<div style="display:flex;flex-wrap:wrap;gap:5px">','<button id="firewall-policy-customizer-ok">OK</button>',"</div>",'<div style="display:flex;flex-wrap:wrap;gap:5px">',[...s].map(e=>"".concat("<label>",c.has(e)?'<input type="checkbox" name="firewall-policy-columns" value="'+e+'" checked>':'<input type="checkbox" name="firewall-policy-columns" value="'+e+'">',e,"</label>")).join(""),"</div>","</div>"),a=document.createElement("style");a.innerHTML=".sticky-table td { border: 1px solid white; } .sticky-table .header td { border-bottom: 0px; }",document.head.appendChild(a);let o="".concat('<button id="firewall-policy-customizer-trigger">Select&nbsp;&rsaquo;</button>','<button id="firewall-policy-customizer-default" '+(c.size==i.size&&[...c].every(e=>i.has(e))?"disabled":"")+">Default</button>",'<button id="firewall-policy-customizer-all" '+(c.size==s.size?"disabled":"")+">All</button>",'<div style="width:100%;height:calc(100vh - 95px);overflow:auto">','<table class="sticky-table" style="margin-bottom:10px;border-spacing: 0;">','<tr class="sticky-table header" style="position:sticky;top:0;text-align:center;color:#fff;background-color:#5A5A5A;border-spacing:0;border-collapse:collapse;z-index:1">',"<td>","#","</td>",[...c].map(e=>"".concat('<td style="padding:5px 10px;text-wrap:nowrap">',e,"</td>")).join(""),"</tr>",n.results.map((e,t)=>"".concat('<tr style="text-align:center;background-color:'+(t%2?"rgba(0, 0, 0, .1)":"rgba(0, 0, 0, .3)")+'">','<td style="padding: 0 5px">',t+1,"</td>",[...c].map(t=>{let n;return("srcintf"==t||"dstintf"==t)&&(n=e[t].map(e=>{let t=r.results.find(t=>t.name==e.name),n=t.icon;return"<div style='display: flex;'><f-icon class='"+n+"'></f-icon><span>"+e.name+"</span></div>"}).join("</br>")),"".concat('<td style="padding: 5px">',["srcintf","dstintf","srcaddr","dstaddr","poolname","service"].includes(t)?n||e[t].map(e=>e["css-class"]?"<div style='display: flex;'><f-icon class='"+e["css-class"]+"'></f-icon><span>"+e.name+"</span></div>":e.name).join("<br>"):"object"==typeof e[t]?"schedule"==t?e[t].name:JSON.stringify(e[t]):e[t],"</td>").replace(/[eE]nable/g,'<f-icon class="fa-enabled"></f-icon>&nbsp;Enabled').replace(/[dD]isable/g,'<f-icon class="fa-disabled"></f-icon>&nbsp;Disabled').replace(/[aA]ccept/g,'<f-icon class="fa-accepted"></f-icon>&nbsp;Accept')}).join(""),"</tr>")).join(""),"<tr>",'<td colspan="'+(c.size+1)+'" style="text-align:center;color:lightgray">',"Implicit deny of all connections which are not allowed by the rules above.","</td>","</tr>","</table>","</div>"),l=document.createElement("div");l.setAttribute("id","fwpol"),l.innerHTML="".concat(t,o),e.innerHTML="",e.style.overflow="auto",e.style.padding="1.5rem",e.appendChild(l),document.getElementById("firewall-policy-customizer-trigger").addEventListener("click",()=>{document.getElementById("firewall-policy-customizer").style.display="block"}),document.getElementById("firewall-policy-customizer-ok").addEventListener("click",()=>{let e=document.getElementsByName("firewall-policy-columns");for(let t of(c.clear(),e))t.checked&&c.add(t.value);p()}),document.getElementById("firewall-policy-customizer-default").addEventListener("click",()=>{for(let e of(c.clear(),i))c.add(e);p()}),document.getElementById("firewall-policy-customizer-all").addEventListener("click",()=>{for(let e of(c.clear(),s))c.add(e);p()})};p()}}],S=document.querySelector("nu-nav-entry"),_=document.createElement("li");_.style.listStyle="none",_.style.cursor="pointer",_.id="tools",_.innerHTML='<div id="menu-toggle" style="position:relative;color:#000;background-color:goldenrod;margin:0;padding:4px 4px 1px 5px;border-left:3px solid #ffd700;display:flex;"><f-icon class="ftnt-webhook icon-lg"></f-icon>&nbsp;Tools<nu-icon class="icon" style="margin-left:auto;width:18px;height:18px;transform:rotate(90deg)">'+d+"</div>",_.addEventListener("mousedown",e=>{e.preventDefault()}),S.before(_),document.addEventListener("click",function(e){let t=e.target.closest("a.menu-label");if(t){let n=document.getElementById("custom-menu"),a=n.getElementsByTagName("li");for(let r=0;r<a.length;r++){let i=a[r];i.dataset.active="",i.style.backgroundColor="#FFD700"}let s=document.getElementById("ng1-app").parentElement,o=s.children;for(let l=0;l<o.length;l++){let d=o[l];"custom-ng1-app"!==d.id&&d.setAttribute("style","")}let c=document.getElementById("custom-ng1-app");c&&c.parentNode.removeChild(c)}});let A=!0,T=document.createElement("ul");async function L(e){let t=document.querySelector("nu-nav-entry.active");t&&t.classList.remove("active");let n,a=document.getElementById("ng1-app"),r=document.getElementById("custom-ng1-app");r||((r=document.createElement("div")).id="custom-ng1-app",r.className="ng1 ng-tns-c49-0 ng-scope"),a.parentElement.insertBefore(r,a),n=e.content,r.style.width="calc(100% - 3rem)",r.innerHTML="".concat('<div style="position:relative;overflow-y:auto"><pre style="padding:1em;margin:0;display:flex"><code style="width:100%; display:flex; justify-content:center">',n||'<span style="padding-top:42vh"><f-icon class="fa-loading icon-xxl"></f-icon></span>',"</code></pre></div>");let i=a.parentElement,s=i.children;for(let o=0;o<s.length;o++){let l=s[o];"custom-ng1-app"!==l.id&&(l.style.display="none")}e.script?.(r)}T.id="custom-menu",T.style.margin=0,T.style.padding=0,k.forEach((e,t)=>{let a=n();a.innerText=e.label,a.onclick=async function(){let t=T.querySelectorAll("li");t.forEach(e=>{e.dataset.active="",e.style.backgroundColor="#FFD700"}),this.dataset.active="active",await L(e),this.style.backgroundColor="#FFE86D"},T.appendChild(a)});let P=document.querySelector("#tools #menu-toggle"),I=P.querySelector(".icon");P.after(T),P.onclick=()=>{A?(T.style.display="none",I.style.transform="rotate(0deg)",A=!1):(T.style.display="block",I.style.transform="rotate(90deg)",A=!0)}})();
```
ðŸŽ¯ Result:
![FGT WebUI](https://www.dannyjung.de/fgt-webui-tools.png)
